var current_fs,next_fs,previous_fs,left,opacity,scale,animating,name=$("#customerName").val(),email=$("#email").val(),depart=$("#department").val(),insti=$("#insti").val(),require=$("#requi").val();function uploadFile(e,t,s,a){const n=new XMLHttpRequest;n.open("POST",t.url),n.onreadystatechange=(()=>{4===n.readyState&&(200===n.status||204===n.status?($("#uploadedFileUrl").val(s),$("#submitForm").css("display","none"),$("#secondB").removeAttr("disabled"),$("#secondB").css({display:"",background:"#27AE60"}),alert("Your file is uploaded")):(alert("Could not upload file."),$("#submitForm").val("Upload")))}),n.send(e)}function getSignedRequest(e){const t=new XMLHttpRequest;t.open("GET",`/sign-s3?file-name=${encodeURIComponent(e.name)}&file-type=${encodeURIComponent(e.type)}`),t.onreadystatechange=(()=>{if(4===t.readyState)if(200===t.status){const e=JSON.parse(t.responseText);let s=new FormData;const a=document.getElementById("fileUpload").files[0];s.append("Content-Type",a.type),Object.entries(e.signedRequest.fields).forEach(([e,t])=>{s.append(e,t)}),s.append("file",a),uploadFile(s,e.signedRequest,e.url,e.fileName)}else alert("Could not get signed URL.")}),t.send()}$(".next").on("click",function(){if(animating)return!1;animating=!0,current_fs=$(this).parent(),next_fs=$(this).parent().next(),$("#qkres-progressbar li").eq($("fieldset").index(next_fs)).addClass("active"),next_fs.show(),current_fs.animate({opacity:0},{step:function(e,t){scale=1-.2*(1-e),left=50*e+"%",opacity=1-e,current_fs.css({transform:"scale("+scale+")",position:"absolute"}),next_fs.css({left:left,opacity:opacity})},duration:800,complete:function(){current_fs.hide(),animating=!1},easing:"easeInOutBack"})}),$(".previous").on("click",function(){if(animating)return!1;animating=!0,current_fs=$(this).parent(),previous_fs=$(this).parent().prev(),$("#qkres-progressbar li").eq($("fieldset").index(current_fs)).removeClass("active"),previous_fs.show(),current_fs.animate({opacity:0},{step:function(e,t){scale=.8+.2*(1-e),left=50*(1-e)+"%",opacity=1-e,current_fs.css({left:left}),previous_fs.css({transform:"scale("+scale+")",opacity:opacity})},duration:800,complete:function(){current_fs.hide(),animating=!1},easing:"easeInOutBack"})}),$("#customerName,#email,#department,#insti,#phone, textarea").on("keyup",function(){""!=$("#customerName").val()&&""!=$("#email").val()&&""!=$("#phone").val()&&""!=$("#department").val()&&""!=$("#insti").val()&&""!=$("textarea").val()?($("#firstB").css("background","#27AE60"),$("#firstB").removeAttr("disabled")):($("#firstB").attr("disabled","disabled"),$("#firstB").css("background","#e6e6e6"))}),$("#fileUpload").on("change",function(){if(!$("#fileUpload").val())return $("#errorMsg").html(""),$("#submitForm").attr("disabled","disabled"),$("#submitForm").css("background","#e6e6e6"),$("#submitForm").val("Upload"),alert("No file selected.");$("#fileUpload")[0].files[0].size<1536e4?($("#submitForm").removeAttr("disabled"),$("#submitForm").css("background","#27AE60"),$("#errorMsg").html("")):($("#errorMsg").html("File size exceeds 15 Mb"),$("#submitForm").css("background","#e6e6e6"),$("#submitForm").attr("disabled","disabled"))}),$("#uploadedFileUrl").on("keyup",function(){""!=$("#uploadedFileUrl").val()&&($("#submitForm").css("display","none"),$("#secondB").removeAttr("disabled"),$("#secondB").css("display",""))}),document.getElementById("submitForm").onclick=(()=>{""==document.getElementById("uploadedFileUrl").value&&(document.getElementById("submitForm").value="Uploading...",$("#submitForm").attr("disabled","disabled"));const e=document.getElementById("fileUpload").files[0];if(null==e)return alert("No file selected.");getSignedRequest(e)});